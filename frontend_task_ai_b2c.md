# Задача для фронтенда: AI B2C Site (Админка)

## Что сделано на бэкенде

Реализована полностью новая система **ИИ-ассистента для B2C фронта**. На бэке уже готовы:
- 3 таблицы в БД
- CRUD API для админки
- API чата для B2C-клиентов

Нужно добавить на дашборд админки новый раздел **"AI B2C Site"** для управления контекстами ИИ-ассистента.

---

## Раздел 1: Brain Contexts (Главный Мозг)

Это базовые знания и инструкции для ИИ, которые действуют на **всех** этапах.

### API

| Метод | URL | Описание |
|-------|-----|----------|
| GET | `/admin/ai-b2c/brain-contexts` | Список всех контекстов |
| POST | `/admin/ai-b2c/brain-contexts` | Создать контекст |
| PUT | `/admin/ai-b2c/brain-contexts/:id` | Обновить |
| DELETE | `/admin/ai-b2c/brain-contexts/:id` | Удалить |

### Поля формы

| Поле | Тип | Обязательное | Описание |
|------|-----|:---:|----------|
| `title` | string | ✅ | Название контекста (например: "Роль и поведение", "Правила общения") |
| `content` | text (textarea) | ✅ | Текст промпта/инструкции — **большое текстовое поле** |
| `is_active` | boolean (toggle) | — | Включён/выключен (по умолчанию: true) |
| `priority` | number | — | Приоритет (выше = важнее, по умолчанию: 0) |

### UI

- Таблица/список с колонками: Название, Статус (вкл/выкл), Приоритет
- Кнопка "Создать контекст"
- Клик по строке → модалка или страница редактирования
- Кнопка удаления с подтверждением

---

## Раздел 2: Stage Contexts (Контексты этапов)

Это промпты для **каждого этапа** (страницы) B2C-приложения. На каждом этапе ИИ ведёт себя по-разному, в зависимости от контекста.

### API

| Метод | URL | Описание |
|-------|-----|----------|
| GET | `/admin/ai-b2c/stages` | Список этапов |
| POST | `/admin/ai-b2c/stages` | Создать этап |
| PUT | `/admin/ai-b2c/stages/:id` | Обновить |
| DELETE | `/admin/ai-b2c/stages/:id` | Удалить |

### Поля формы

| Поле | Тип | Обязательное | Описание |
|------|-----|:---:|----------|
| `stage_key` | string | ✅ | Уникальный ключ этапа (любая строка, например `AI_B2C_site`) |
| `title` | string | ✅ | Человекочитаемое название этапа для списка |
| `content` | text (textarea) | ✅ | Промпт-инструкция для ИИ на этом этапе — **большое текстовое поле** |
| `is_active` | boolean (toggle) | — | Включён/выключен |
| `priority` | number | — | Приоритет |

### UI

- Таблица с колонками: Ключ этапа, Название, Статус
- Кнопка "Создать этап"
- Клик по строке → модалка/страница редактирования
- **Поле stage_key — обычный текст**, чтобы админ мог вписать любой ключ.

---

## Общие требования

1. **Авторизация**: все запросы с Bearer Token (как и остальные админ-эндпоинты)
2. **Заголовки**: `X-Project-Key` и `X-Project-ID` (как обычно)
3. **Content-Type**: `application/json`
4. **Навигация**: добавить пункт **"AI B2C Site"** в боковое меню админки
5. **Вложенность**: внутри раздела два таба или подраздела:
   - **Brain Contexts** (Главный Мозг)
   - **Stage Contexts** (Этапы)

---

## Пример запросов

### Создать Brain Context
```json
POST /admin/ai-b2c/brain-contexts
{
  "title": "Роль и поведение",
  "content": "Ты — дружелюбный финансовый консультант. Отвечай кратко, по делу, на русском языке. Используй Markdown.",
  "is_active": true,
  "priority": 10
}
```

### Создать Stage Context
```json
POST /admin/ai-b2c/stages
{
  "stage_key": "chooseTarget",
  "title": "Выбор целей",
  "content": "Клиент выбирает финансовые цели. Помоги ему определиться. Расскажи про виды целей: пенсия, недвижимость, образование, пассивный доход. Задавай уточняющие вопросы.",
  "is_active": true,
  "priority": 5
}
```

### Ответ GET (Brain Contexts)
```json
[
  {
    "id": 1,
    "project_id": 4,
    "title": "Роль и поведение",
    "content": "Ты — дружелюбный финансовый консультант...",
    "is_active": true,
    "priority": 10,
    "created_at": "2026-02-18T17:30:00.000Z",
    "updated_at": "2026-02-18T17:30:00.000Z"
  }
]
```
